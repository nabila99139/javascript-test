<!DOCTYPE html>
<html lang="en">

<head>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Beam Analysis TEST</title>
</head>

<body>
    <!-- PLEASE REFRESH PAGE IF YOU WANT TO CHANGE CONDITION  thank you :) ! ! ! -->
    <!-- I use CDN, so please connect to wifi or data to accsess bootstrap and other library -->
    <div class="container-fluid">
        <div class="d-flex flex-column border-1 p-3 m-3 gap-3">
            <div class="d-flex justify-content-center fw-bold h4">Beam Analysis TEST</div>
            <div class="d-flex flex-column gap-1">
                <div class="d-flex">
                    <div class="p-0 w-25">Condition</div>
                    <div class="p-0">
                        <select class="form-select" name="condition" id="condition">
                            <option value="simply-supported">Simply Supported</option>
                            <option value="two-span-unequal">Two Span Unequal</option>
                        </select>
                    </div>
                </div>
                <div class="d-flex">
                    <div class="p-0 w-25">Load Force (w)</div>
                    <div class="d-flex gap-2">
                        <input type="text" class="form-control" id="w">
                    </div>
                </div>
                <div class="d-flex">
                    <div class="p-0 w-25">Primary Span (L1)</div>
                    <div class="d-flex gap-2">
                        <input type="text" class="form-control" id="primarySpan" value="4">
                        <div class="p-0">m</div>
                    </div>
                </div>
                <div class="d-flex">
                    <div class="p-0 w-25">Secondary Span (L2)</div>
                    <div class="d-flex gap-2">
                        <input type="text" class="form-control" id="secondarySpan" value="">
                        <div class="p-0">m</div>
                    </div>
                </div>
            </div>
            <hr>
            <div class="d-flex flex-column gap-1">
                <div class="d-flex">
                    <div class="p-0 w-25">j2</div>
                    <div class="d-flex gap-2">
                        <input type="text" class="form-control" id="j2">
                    </div>
                </div>
                <div class="d-flex">
                    <div class="p-0 w-25">Bending Stiffness (EI)</div>
                    <div class="d-flex gap-2">
                        <input type="text" class="form-control" id="EI" value="3150000000000">
                        <div class="d-flex">Nmm<sup>2</sup></div>
                    </div>
                </div>
            </div>
            <hr>
            <div class="d-flex">
                <button type="button" class="btn btn-primary" id="calculate" onclick="calculate()">Calculate</button>
            </div>
        </div>
    </div>

    <canvas id="shear_force_plot"></canvas>
    <canvas id="bending_moment_plot"></canvas>
    <canvas id="deflection_plot"></canvas>

    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

    <script src="js/beam-analysis.js"></script>
    <script src="js/analysis-plotter.js"></script>
</body>

</html>


<script>
    function calculate() {
        // document.getElementById("calculate").addEventListener("click", function () {
        const L1 = parseFloat(document.getElementById("primarySpan").value);
        const L2 = parseFloat(document.getElementById("secondarySpan").value) || null;
        const EI = parseFloat(document.getElementById("EI").value);
        const w = parseFloat(document.getElementById("w").value);
        const condition = document.getElementById("condition").value;

        // const beam = new Beam(L1, L2,
        //     new Material({
        //         EI
        //     })
        // );

        // new Material({ EI: parseFloat(document.getElementById('EI').value) })
        // new Material('No Name', { EI: parseFloat(document.getElementById('EI').value) })

        const material = new Material({ EI });
        const beam = new Beam(L1, L2, material);
        beam.calculateConstants(w, L1, L2);

        // beam-analysis.js
        const beamAnalysis = new BeamAnalysis();
        const shearForceData = beamAnalysis.getShearForce(beam, w, condition);
        const bendingMomentData = beamAnalysis.getBendingMoment(beam, w, condition);
        const deflectionData = beamAnalysis.getDeflection(beam, w, condition);

        console.log("Deflection Data:", deflectionData);

        // analysis-plotter (chart.js)
        new AnalysisPlotter("shear_force_plot").plot(shearForceData, "Shear Force");
        new AnalysisPlotter("bending_moment_plot").plot(bendingMomentData, "Bending Moment");
        new AnalysisPlotter("deflection_plot").plot(deflectionData, "Deflection");
        // });

    }

</script>
</body>

</html>